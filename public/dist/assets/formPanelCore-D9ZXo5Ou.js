const t=document.getElementById("mobileToggle"),e=document.getElementById("sidebar"),o=document.getElementById("logoutBtn"),c=document.getElementById("logoutBtnMobile"),n=document.getElementById("gradesToggle"),s=document.getElementById("gradesSubmenu"),a=document.querySelectorAll(".section-toggle");async function i(){if((await Swal.fire({title:"تسجيل الخروج",text:"هل تريد فعلاً تسجيل الخروج من النظام؟",icon:"question",iconColor:"#ffcc00",showCancelButton:!0,confirmButtonText:"نعم، تسجيل خروج",cancelButtonText:"إلغاء",confirmButtonColor:"#e74c3c",cancelButtonColor:"#666",background:"#2a1b3c",color:"#fff",backdrop:"rgba(0,0,0,0.8)",allowOutsideClick:!1})).isConfirmed)try{(await fetch("/logout",{method:"POST"})).ok&&(await Swal.fire({title:"تم تسجيل الخروج",text:"وداعاً! تم تسجيل خروجك بنجاح",icon:"success",iconColor:"#27ae60",background:"#2a1b3c",color:"#fff",backdrop:"rgba(0,0,0,0.8)",showConfirmButton:!1,timer:1500}),setTimeout(()=>{window.location.href="/"},500))}catch(t){window.location.href="/"}}t&&t.addEventListener("click",function(){if(e&&t){e.classList.toggle("active");const o=t.querySelectorAll("span");e.classList.contains("active")?(o[0].style.transform="rotate(45deg) translate(5px, 5px)",o[1].style.opacity="0",o[2].style.transform="rotate(-45deg) translate(7px, -6px)"):(o[0].style.transform="none",o[1].style.opacity="1",o[2].style.transform="none")}}),n&&n.addEventListener("click",function(t){t.stopPropagation(),this.classList.toggle("active");const e=this.querySelector(".toggle-icon");this.classList.contains("active")?(e.classList.remove("fa-chevron-down"),e.classList.add("fa-chevron-up"),s.style.maxHeight=Math.min(s.scrollHeight,400)+"px"):(e.classList.remove("fa-chevron-up"),e.classList.add("fa-chevron-down"),s.style.maxHeight="0",document.querySelectorAll(".section-toggle.active").forEach(t=>{t.classList.remove("active");const e=t.querySelector(".toggle-icon");e.classList.remove("fa-chevron-up"),e.classList.add("fa-chevron-down");const o=document.querySelector(`.section-submenu[data-section="${t.dataset.section}"]`);o&&(o.style.maxHeight="0")}))}),a.forEach(t=>{t.addEventListener("click",function(t){t.stopPropagation(),this.classList.toggle("active");const e=this.querySelector(".toggle-icon"),o=document.querySelector(`.section-submenu[data-section="${this.dataset.section}"]`);this.classList.contains("active")?(e.classList.remove("fa-chevron-down"),e.classList.add("fa-chevron-up"),o.style.maxHeight=o.scrollHeight+"px"):(e.classList.remove("fa-chevron-up"),e.classList.add("fa-chevron-down"),o.style.maxHeight="0")})}),o&&o.addEventListener("click",i),c&&c.addEventListener("click",i),document.addEventListener("click",function(o){if(window.innerWidth<=992&&e&&t&&!e.contains(o.target)&&!t.contains(o.target)){e.classList.remove("active");const o=t.querySelectorAll("span");o[0].style.transform="none",o[1].style.opacity="1",o[2].style.transform="none"}});